<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω–∫–∞</title>
    <link rel="stylesheet" href="style1.css">
</head>
<body>
    <div class='login-container' id='loginContainer' style='display:none;'>
        <form id='adminLoginForm'>
            <h2>–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω–∫–µ</h2>
            <div class='form-group'>
                <label for='admin-password'>–ü–∞—Ä–æ–ª—å:</label>
                <input type='password' id='admin-password' required>
                <button type='button' id='togglePassword'>üëÅÔ∏è</button> 
            </div>
            <button type='submit'>–í–æ–π—Ç–∏</button>
        </form>
    </div>

    <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∫–∏ -->
    <div class='sidebar' id='sidebar' style='display:none;'>
        <img src='free-icon-boy-4537069.png' alt='–õ–æ–≥–æ—Ç–∏–ø'> 
        <h2>–ê–¥–º–∏–Ω–∫–∞</h2>
        <a href='correct.html'>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</a>
        <a href='mer.html' id='viewOrdersLink'>–ó–∞—è–≤–∫–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π</a> 
        <a id='logoutBtn' href='#'>–í—ã—Ö–æ–¥</a> 
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞–¥–º–∏–Ω–∫–∏ -->
    <section class='admin-panel' id='adminContent' style='display:none;'> 
        <h2>–ó–∞–∫–∞–∑—ã –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π</h2> 
        <!-- –¢–∞–±–ª–∏—Ü–∞ –∑–∞–∫–∞–∑–æ–≤ -->
        <table id='orderTable'> 
            <thead> 
                <tr> 
                    <th>–ö–æ–¥ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</th> 
                    <th>–ù–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</th> 
                    <th>–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è</th> 
                    <th>–ú–µ—Å—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è</th> 
                    <th>–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ –ª–∏—Ü–æ</th> 
                    <th>–°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</th> 
                    <th>–°–æ—Å—Ç–æ—è–Ω–∏–µ</th> 
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>  
                </tr> 
            </thead> 
            <tbody></tbody> <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–∞–∫–∞–∑—ã --> 
        </table>

        <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ –∏–ª–∏ –æ—à–∏–±–∫–µ --> 
        <div id='orderMessage'></div>

    </section>

    <!-- –°–∫—Ä–∏–ø—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã –∞–¥–º–∏–Ω–∫–∏ -->
    <script>
        const adminPassword = 'ewqewq'; 

        if (!localStorage.getItem("admin")) {  
            localStorage.setItem("admin", JSON.stringify({ password: adminPassword }));  
        }

        if (sessionStorage.getItem("isAdminLoggedIn")) {  
            document.querySelector("#loginContainer").style.display = "none";  
            document.querySelector("#sidebar").style.display = "block";  
            document.querySelector("#adminContent").style.display = "block";  

            loadOrders();  
        } else {  
            document.querySelector("#loginContainer").style.display = "flex";  
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –∞–¥–º–∏–Ω–∫—É
        document.querySelector("#adminLoginForm").addEventListener("submit", function(event) {  
            event.preventDefault();  
            const passwordInputValue = document.querySelector("#admin-password").value;

            if (passwordInputValue === adminPassword) {  
                sessionStorage.setItem("isAdminLoggedIn", "true");  
                loadOrders();  
                showAdminPanel();
            } else {  
                alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!");  
            }  
        });

        function showAdminPanel() {  
            document.querySelector("#loginContainer").style.display = "none";  
            document.querySelector("#sidebar").style.display = "block";  
            document.querySelector("#adminContent").style.display = "block";  
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–æ–≤ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π
        function loadOrders() {  
            const orders = JSON.parse(localStorage.getItem("eventOrders")) || [];  

            const tbody = document.querySelector("#orderTable tbody");  

            tbody.innerHTML = ""; // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ

            orders.forEach((order, index) => {  
                const row = document.createElement("tr");  

                row.innerHTML = `
                    <td>${order.code}</td>
                    <td>${order.name}</td>
                    <td>${order.dateTime}</td>
                    <td>${order.location}</td>
                    <td>${order.responsible}</td>
                    <td>${order.participants}</td>
                    <td>
                        <select onchange='updateOrderStatus(${index}, this.value)'>
                            <option value='–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ' ${order.status === '–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ' ? 'selected' : ''}>–í –ø—Ä–æ—Ü–µ—Å—Å–µ</option>
                            <option value='–ø—Ä–∏–Ω—è—Ç–æ' ${order.status === '–ø—Ä–∏–Ω—è—Ç–æ' ? 'selected' : ''}>–ü—Ä–∏–Ω—è—Ç–æ</option>
                            <option value='–æ—Ç–∫–∞–∑–∞–Ω–æ' ${order.status === '–æ—Ç–∫–∞–∑–∞–Ω–æ' ? 'selected' : ''}>–û—Ç–∫–∞–∑–∞–Ω–æ</option>
                        </select>
                    </td>
                    <td><button onclick='deleteOrder(${index})'>–£–¥–∞–ª–∏—Ç—å</button></td>`;
                
                tbody.appendChild(row);
            });
        }

        function updateOrderStatus(index, status) {  
            const orders = JSON.parse(localStorage.getItem("eventOrders")) || [];  

            orders[index].status = status;  

            localStorage.setItem("eventOrders", JSON.stringify(orders));  
        }

        function deleteOrder(index) {  
            const orders = JSON.parse(localStorage.getItem("eventOrders")) || [];  

            orders.splice(index, 1);  

            localStorage.setItem("eventOrders", JSON.stringify(orders));  

            loadOrders();  
        }

        // –í—ã—Ö–æ–¥ –∏–∑ –∞–¥–º–∏–Ω–∫–∏
        document.querySelector("#logoutBtn").addEventListener("click", function() {  
            sessionStorage.removeItem("isAdminLoggedIn");  
            window.location.reload();  
        });
    </script>
</body>
</html>
